<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USF下载站</title>
    <link rel="stylesheet" type="text/css" href="/config/style.css">
    <script src="config/file.js"></script>
    <script src="config/logic.js"></script>
    <style>

    </style>
</head>
<body>
<header>
    <div class="logo">
        <img src="https://s21.ax1x.com/2024/10/02/pA3hMjS.png" alt="Logo">
    </div>
    <button href="http://usf.jmcs.cf?project" class="back-btn">返回文档站</button>
</header>

<section style="margin-top:80px;">
    <div class="container">
        <!-- 筛选器 -->
        <div class="filter-container">
            <div class="filter-category">版本</div>
            <button class="filter-btn selected" data-tag="全部" id="version-all">全部</button>
            <button class="filter-btn" data-tag="正式版" id="version-official">正式版</button>
            <button class="filter-btn" data-tag="测试版" id="version-test">测试版</button>
            <div class="filter-separator"></div>
            <div class="filter-category">版本号</div>
            <button class="filter-btn selected" data-tag="全部" id="version-number-all">全部</button>
            <button class="filter-btn" data-tag="1.22" id="version-1.22">1.22</button>
            <button class="filter-btn" data-tag="1.21" id="version-1.21">1.21</button>
            <button class="filter-btn" data-tag="1.20" id="version-1.20">1.20</button>
            <button class="filter-btn" data-tag="1.19" id="version-1.19">1.19</button>
        </div>

        <div id="download-list"></div>
        <p id="no-more" style="display:none;">没有更多了</p>

        <div id="modal" class="modal">
            <div class="modal-header">分享链接</div>
            <p id="download-url"></p>
            <div class="modal-footer">
                <button class="btn modal-close">关闭</button>
                <button class="btn" id="copy-url">复制链接</button>
            </div>
        </div>
    </div>
<footer>
    <p>本站点由ZUY Studio维护</p>
    <p>© 2024 地球DLL.&ZUY Studio All Rights Reserved.</p>
    <p>未经作者许可严禁将插件二次分发与盈利</p>
</footer>

<script>
// 获取下载列表容器
const downloadList = document.getElementById('download-list');
const modal = document.getElementById('modal');
const downloadUrl = document.getElementById('download-url');
const noMoreMessage = document.getElementById('no-more');

// 动态生成下载项目
function renderFiles(versionTag = '全部', versionNumber = '全部') {
    downloadList.innerHTML = ''; // 清空列表
    noMoreMessage.style.display = 'none'; // 隐藏“没有更多了”信息

    const filteredFiles = files.filter(file => {
        let versionMatch = versionTag === '全部' || file.tags.includes(versionTag);
        let numberMatch = versionNumber === '全部' || file.tags.includes(versionNumber);

        return versionMatch && numberMatch;
    });

    if (filteredFiles.length === 0) {
        noMoreMessage.style.display = 'block';
        return;
    }

    filteredFiles.forEach(file => {
        const downloadItem = `
<div class="download-item">
                            <h3>${file.name}</h3>
                            <p>${file.description}</p>
                            <span class="show-more">展开更多</span>
                            <div class="download-tags">标签: ${file.tags.join(', ')}</div>
                            <div class="button-container">
                                <button class="btn" onclick="openShareModal('${file.downloadLink}')">
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M18 8C19.1 8 20 8.9 20 10V18C20 19.1 19.1 20 18 20H6C4.9 20 4 19.1 4 18V10C4 8.9 4.9 8 6 8H8V6C8 3.8 9.8 2 12 2C14.2 2 16 3.8 16 6V8H18ZM12 12V17H14L12 19L10 17H12V12H10L12 14L14 12H12ZM16 8V6C16 4.9 15.1 4 14 4C12.9 4 12 4.9 12 6V8H16Z" fill="#333"/>
                                    </svg>
                                    分享
                                </button>
                                <button class="btn" onclick="window.location.href='${file.feedbackLink}'">
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 2C13.65 2 15 3.35 15 5C15 6.65 13.65 8 12 8C10.35 8 9 6.65 9 5C9 3.35 10.35 2 12 2ZM6 22C5.45 22 5 21.55 5 21C5 17.13 8.13 14 12 14C15.87 14 19 17.13 19 21C19 21.55 18.55 22 18 22H6Z" fill="#333"/>
                                    </svg>
                                    反馈
                                </button>
                                <button class="btn" onclick="window.location.href='${file.downloadLink}'">
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M19 9H15V3H9V9H5L12 16L19 9ZM5 18H19V20H5V18Z" fill="#333"/>
                                    </svg>
                                    下载
                                </button>
                            </div>
                        </div>
        `;

        downloadList.innerHTML += downloadItem;
    });

    // 添加进入动画
    setTimeout(() => {
        const items = document.querySelectorAll('.download-item');
        items.forEach(item => item.classList.add('show'));
    }, 100);
}

// 初次渲染所有文件
renderFiles();

// 监听筛选按钮点击
const filterButtons = document.querySelectorAll('.filter-btn');
let selectedVersion = '全部';
let selectedVersionNumber = '全部';

filterButtons.forEach(button => {
    button.addEventListener('click', () => {
        const tag = button.dataset.tag;

        // 版本类型只能选一个（全部，正式版，测试版）
        if (tag === '全部' || tag === '正式版' || tag === '测试版') {
            selectedVersion = tag;

            // 取消所有版本类型按钮的选中状态
            document.querySelectorAll('#version-all, #version-official, #version-test').forEach(btn => btn.classList.remove('selected'));
            button.classList.add('selected');
        }

        // 版本号只能选一个
        if (tag === '全部' || tag.startsWith('1.')) {
            selectedVersionNumber = tag;

            // 取消所有版本号按钮的选中状态
            document.querySelectorAll('[id^="version-1."], #version-number-all').forEach(btn => btn.classList.remove('selected'));
            button.classList.add('selected');
        }

        // 根据选中的标签渲染文件
        renderFiles(selectedVersion, selectedVersionNumber);
    });
});


function openShareModal(link) {
    const baseUrl = "https://usfdown.zuyst.top/";
    downloadUrl.textContent = baseUrl + link;
    modal.classList.add('show');
}


// 关闭弹出框
document.querySelector('.modal-close').addEventListener('click', () => {
    modal.classList.remove('show');
});

// 复制链接
document.getElementById('copy-url').addEventListener('click', () => {
    navigator.clipboard.writeText(downloadUrl.textContent).then(() => {
        alert('链接已复制到剪贴板');
    });
});

document.addEventListener('DOMContentLoaded', function() {
    var downloadItems = document.querySelectorAll('.download-item');

    downloadItems.forEach(function(item) {
        var p = item.querySelector('p');
        var showMoreButton = item.querySelector('.show-more');

        var originalHeight = p.scrollHeight;
        p.style.webkitLineClamp = '3'; 
        var limitedHeight = p.getBoundingClientRect().height;

        if (originalHeight > limitedHeight) {
            showMoreButton.style.display = 'inline-block'; 
        }

        showMoreButton.addEventListener('click', function() {
            p.classList.toggle('expanded');
            if (p.classList.contains('expanded')) {
                this.textContent = '收起';
            } else {
                this.textContent = '展开更多';
            }
        });
    });
});
</script>

</body>
</html>
            <div class="modal-header">分享链接</div>
            <p id="download-url"></p>
            <div class="modal-footer">
                <button class="btn modal-close">关闭</button>
                <button class="btn" id="copy-url">复制链接</button>
            </div>
        </div>
    </div>
<footer>
    <p>本站点由ZUY Studio维护</p>
    <p>© 2024 地球DLL.&ZUY Studio All Rights Reserved.</p>
    <p>未经作者许可严禁将插件二次分发与盈利</p>
</footer>
    <script>
        // 获取下载列表容器
        const downloadList = document.getElementById('download-list');
        const modal = document.getElementById('modal');
        const downloadUrl = document.getElementById('download-url');

        // 动态生成下载项目
        function renderFiles(filterTags = []) {
            downloadList.innerHTML = ''; // 清空列表

            files.forEach(file => {
                // 如果没有选择任何标签，或文件的标签与选择的标签有交集，则显示该文件
                if (filterTags.length === 0 || file.tags.some(tag => filterTags.includes(tag))) {
                    const downloadItem = `
                        <div class="download-item">
                            <h3>${file.name}</h3>
                            <p>${file.description}</p>
                            <span class="show-more">展开更多</span>
                            <div class="download-tags">标签: ${file.tags.join(', ')}</div>
                            <div class="button-container">
                                <button class="btn" onclick="openShareModal('${file.downloadLink}')">
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M18 8C19.1 8 20 8.9 20 10V18C20 19.1 19.1 20 18 20H6C4.9 20 4 19.1 4 18V10C4 8.9 4.9 8 6 8H8V6C8 3.8 9.8 2 12 2C14.2 2 16 3.8 16 6V8H18ZM12 12V17H14L12 19L10 17H12V12H10L12 14L14 12H12ZM16 8V6C16 4.9 15.1 4 14 4C12.9 4 12 4.9 12 6V8H16Z" fill="#333"/>
                                    </svg>
                                    分享
                                </button>
                                <button class="btn" onclick="window.location.href='${file.feedbackLink}'">
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 2C13.65 2 15 3.35 15 5C15 6.65 13.65 8 12 8C10.35 8 9 6.65 9 5C9 3.35 10.35 2 12 2ZM6 22C5.45 22 5 21.55 5 21C5 17.13 8.13 14 12 14C15.87 14 19 17.13 19 21C19 21.55 18.55 22 18 22H6Z" fill="#333"/>
                                    </svg>
                                    反馈
                                </button>
                                <button class="btn" onclick="window.location.href='${file.downloadLink}'">
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M19 9H15V3H9V9H5L12 16L19 9ZM5 18H19V20H5V18Z" fill="#333"/>
                                    </svg>
                                    下载
                                </button>
                            </div>
                        </div>
                    `;

                    downloadList.innerHTML += downloadItem;
                }
            });
        }

 
        // 初次渲染所有文件
        renderFiles();

        // 监听筛选按钮点击
        const filterButtons = document.querySelectorAll('.filter-btn');
        filterButtons.forEach(button => {
            button.addEventListener('click', () => {
                button.classList.toggle('selected');

                // 获取所有选中的标签
                const selectedTags = Array.from(filterButtons)
                    .filter(btn => btn.classList.contains('selected'))
                    .map(btn => btn.getAttribute('data-tag'));

                // 根据选中的标签渲染文件
                renderFiles(selectedTags);
            });
        });
   
        function openShareModal(link) {
            downloadUrl.textContent = link;
            modal.classList.add('show');
        }

        // 关闭弹出框
        document.querySelector('.modal-close').addEventListener('click', () => {
            modal.classList.remove('show');
        });

        // 复制链接
        document.getElementById('copy-url').addEventListener('click', () => {
            navigator.clipboard.writeText(downloadUrl.textContent).then(() => {
                alert('链接已复制到剪贴板');
            });
        });


document.addEventListener('DOMContentLoaded', function() {
    var downloadItems = document.querySelectorAll('.download-item');

    downloadItems.forEach(function(item) {
        var p = item.querySelector('p');
        var showMoreButton = item.querySelector('.show-more');

        // 检测简介的实际高度
        var originalHeight = p.scrollHeight;
        p.style.webkitLineClamp = '3'; // 限制为3行后，重新计算高度
        var limitedHeight = p.getBoundingClientRect().height;

        // 如果实际高度大于容器高度，显示按钮
        if (originalHeight > limitedHeight) {
            showMoreButton.style.display = 'inline-block'; // 显示"展开更多"按钮
        }

        // 添加展开/收起功能
        showMoreButton.addEventListener('click', function() {
            p.classList.toggle('expanded');
            if (p.classList.contains('expanded')) {
                this.textContent = '收起';
            } else {
                this.textContent = '展开更多';
            }
        });
    });
});



    </script>

</body>
</html>
